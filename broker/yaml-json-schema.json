{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "MonsterMQ",
  "type": "object",
  "properties": {
    "TCP": {
      "type": "integer",
      "default": 1883
    },
    "WS": {
      "type": "integer",
      "default": 0
    },
    "TCPS": {
      "type": "integer",
      "default": 0,
      "description": "TCP port for SSL connection"
    },
    "WSS": {
      "type": "integer",
      "default": 0,
      "description": "WS port for SSL connection"
    },
    "NodeName": {
      "type": "string",
      "description": "Custom node name for cluster identification (defaults to hostname if not set)"
    },
    "MaxMessageSizeKb": {
      "type": "integer",
      "default": 8
    },
    "MaxPublishRate": {
      "type": "integer",
      "default": 0,
      "description": "Maximum messages per second a client can publish (0 = unlimited)"
    },
    "MaxSubscribeRate": {
      "type": "integer",
      "default": 0,
      "description": "Maximum messages per second a client can receive (0 = unlimited)"
    },
    "Kafka": {
      "type": "object",
      "properties": {
        "Servers": {
          "type": "string"
        },
        "Bus": {
          "type": "object",
          "default": false,
          "Enabled": {
            "type": "boolean",
            "default": false
          },
          "Topic": {
            "type": "string",
            "default": "monster"
          }
        }
      },
      "required": [
        "Servers"
      ]
    },
    "SessionStoreType": {
      "type": "string",
      "enum": [
        "POSTGRES",
        "CRATEDB",
        "MONGODB",
        "SQLITE"
      ]
    },
    "RetainedStoreType": {
      "type": "string",
      "enum": [
        "MEMORY",
        "HAZELCAST",
        "POSTGRES",
        "CRATEDB",
        "MONGODB",
        "SQLITE"
      ]
    },
    "QueuedMessagesEnabled": {
      "type": "boolean",
      "default": true
    },
    "AllowRootWildcardSubscription": {
      "type": "boolean",
      "default": true,
      "description": "Allow clients to subscribe to '#' (root wildcard). If false, SUBSCRIBE acknowledgements for '#' return failure (0x80) and the client remains connected."
    },
    "Logging": {
      "type": "object",
      "description": "System logging configuration",
      "properties": {
        "MqttEnabled": {
          "type": "boolean",
          "description": "Enable MQTT log handler to publish all Java logs to $SYS/syslogs/<node>/<level> topics",
          "default": false
        },
        "MqttLevel": {
          "type": "string",
          "description": "Minimum log level for MQTT publishing (ALL, FINEST, FINER, FINE, INFO, WARNING, SEVERE)",
          "default": "INFO",
          "enum": ["ALL", "FINEST", "FINER", "FINE", "INFO", "WARNING", "SEVERE"]
        }
      }
    },
    "ConfigStoreType": {
      "type": "string",
      "enum": [
        "POSTGRES",
        "CRATEDB",
        "MONGODB",
        "SQLITE"
      ],
      "description": "Database type for storing archive configuration"
    },
    "Postgres": {
      "type": "object",
      "properties": {
        "Url": {
          "type": "string"
        },
        "User": {
          "type": "string"
        },
        "Pass": {
          "type": "string"
        }
      },
      "required": [
        "Url",
        "User",
        "Pass"
      ]
    },
    "CrateDB": {
      "type": "object",
      "properties": {
        "Url": {
          "type": "string"
        },
        "User": {
          "type": "string"
        },
        "Pass": {
          "type": "string"
        }
      },
      "required": [
        "Url",
        "User",
        "Pass"
      ]
    },
    "MongoDB": {
      "type": "object",
      "properties": {
        "Url": {
          "type": "string"
        },
        "Database": {
          "type": "string"
        }
      },
      "required": [
        "Url"
      ]
    },
    "SQLite": {
      "type": "object",
      "properties": {
        "Path": {
          "type": "string",
          "description": "Path to SQLite database file",
          "default": "monstermq.db"
        },
        "EnableWAL": {
          "type": "boolean",
          "description": "Enable WAL (Write-Ahead Logging) mode for better performance. Set to false for easier multi-client access.",
          "default": true
        }
      }
    },
    "MCP": {
      "type": "object",
      "description": "Model Context Protocol server configuration",
      "properties": {
        "Enabled": {
          "type": "boolean",
          "description": "Enable MCP server for AI integration",
          "default": true
        },
        "Port": {
          "type": "integer",
          "description": "Port for MCP server HTTP endpoint",
          "default": 3000,
          "minimum": 1,
          "maximum": 65535
        }
      }
    },
    "GraphQL": {
      "type": "object",
      "description": "GraphQL server configuration",
      "properties": {
        "Enabled": {
          "type": "boolean",
          "description": "Enable GraphQL server",
          "default": false
        },
        "Port": {
          "type": "integer",
          "description": "Port for GraphQL HTTP endpoint",
          "default": 8080,
          "minimum": 1,
          "maximum": 65535
        },
        "Path": {
          "type": "string",
          "description": "Path for GraphQL endpoint",
          "default": "/graphql"
        },
        "CorsEnabled": {
          "type": "boolean",
          "description": "Enable CORS for GraphQL endpoint",
          "default": true
        }
      }
    },
    "ArchiveGroups": {
      "type": "array",
      "description": "Archive group configurations",
      "items": {
        "type": "object",
        "properties": {
          "Name": { "type": "string" },
          "TopicFilter": { "type": "array", "items": {"type": "string"} },
          "RetainedOnly": { "type": "boolean", "default": false },
          "LastValType": { "type": "string", "enum": ["MEMORY","HAZELCAST","POSTGRES","CRATEDB","MONGODB","SQLITE","NONE"], "default": "MEMORY" },
          "ArchiveType": { "type": "string", "enum": ["NONE","POSTGRES","CRATEDB","MONGODB","KAFKA","SQLITE"], "default": "NONE" },
          "LastValRetention": { "type": ["string","null"], "description": "Duration like 1h, 30m" },
          "ArchiveRetention": { "type": ["string","null"], "description": "Duration like 24h, 7d" },
          "PurgeInterval": { "type": ["string","null"], "description": "Purge interval duration" },
          "PayloadFormat": { "type": "string", "enum": ["DEFAULT","JSON"], "default": "DEFAULT", "description": "Payload storage format" }
        },
        "required": ["Name","TopicFilter","LastValType","ArchiveType"]
      }
    }
  },
  "required": [
    "TCP"
  ]
}